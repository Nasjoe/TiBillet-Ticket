<fieldset class="maj-theme col shadow-sm p-3 mb-5 bg-body rounded">
    <legend>
        <h3 class="font-weight-bolder text-info text-gradient align-self-start">
            Email
        </h3>
    </legend>
    {% if user.is_active == True %}
        <h4 role="heading" aria-label="Email de l'utilisateur connecté.">
            {{ profile.email }}
        </h4>
    {% else %}
        <div>
            <!-- email -->
            <div class="input-group input-group-dynamic mb-4">
                <label class="form-label">Email</label>
                <input id="card-email-email" name="card-email-email" type="email" class="form-control" required>
            </div>

            <!-- confirm email -->
            <div class="input-group input-group-dynamic mb-4">
                <label class="form-label">Confirmer email</label>
                <input id="card-email-confirm-email" name="card-email-confirm-email" type="text" class="form-control" required>
            </div>

            <!-- message pour l'adresse email -->
            <div class="text-warning mb-0">
                Merci de bien vérifier votre adresse email afin de bien recevoir
                votre(vos) billet(s).
            </div>
        </div>
    {% endif %}
</fieldset>

<script>
  function testSameEmail() {
    console.log('-> testSameEmail :')
    const inputConfirmEmail = document.querySelector('#card-email-confirm-email')
    const emailValue = document.querySelector('#card-email-confirm-email').value
    if (emailValue === inputConfirmEmail.value && emailValue !== '') {
      inputConfirmEmail.parentNode.classList.remove('is-invalid')
      inputConfirmEmail.parentNode.classList.add('is-valid')
    } else {
      inputConfirmEmail.parentNode.classList.remove('is-valid')
      inputConfirmEmail.parentNode.classList.add('is-invalid')
    }
  }

  // désactivation du test de conformité d'email par l'atttribut "type" = "text"
  // et test de l'email de confirmation
  if (document.querySelector('#card-email-confirm-email') !== null) {
    document.querySelector('#card-email-confirm-email').addEventListener('keyup', testSameEmail)
    document.querySelector('#card-email-confirm-email').addEventListener('change', testSameEmail)
    document.querySelector('#card-email-confirm-email').addEventListener('blur', testSameEmail)
  }
</script>